<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>Data Extractor & Formatter</title>
  <link rel="icon" href="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20100%20100'%3E%3Ctext%20x='50%25'%20y='50%25'%20dominant-baseline='central'%20text-anchor='middle'%20font-size='85'%20font-family='sans-serif'%20font-weight='bold'%20fill='%2360a5fa'%3ED%3C/text%3E%3C/svg%3E">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    .copy-btn.copied { background-color: #22c55e; color: white; }
    body { font-family: 'Inter', sans-serif; }
    .output-item { display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; }
    .output-item:last-child { border-bottom: none; }
    .output-label { font-weight: 600; margin-right: 0.5rem; white-space: nowrap; flex-shrink: 0; }
    .output-value { flex-grow: 1; text-align: left; word-break: break-word; margin-right: 0.5rem; padding: 0.25rem 0.5rem; border-radius: 0.25rem; }
    .output-value[contenteditable="true"] { outline: 2px solid #60a5fa; background-color: #374151; }
    .output-value.needs-review, .output-value.suggested-invalid-hex { color: #f87171; }
    .copy-btn, .edit-btn, .search-btn { margin-left: 0.5rem; padding: 0.3rem 0.6rem; font-size: 0.8rem; transition: background-color 0.2s ease, color 0.2s ease; flex-shrink: 0; border-radius: 0.375rem; cursor: pointer; }
    .filename-section { display: flex; align-items: center; justify-content: space-between; padding: 1rem; border-radius: 0.375rem; }
    #filenameOutput { flex-grow: 1; margin-right: 1rem; padding: 0.25rem 0.5rem; border-radius: 0.25rem; }
    #filenameOutput[contenteditable="true"] { outline: 2px solid #60a5fa; background-color: #374151; }
    #pageTitle { cursor: pointer; user-select: none; }
    #imageUploadLabel { cursor: pointer; padding: 0.5rem 1rem; border-radius: 0.375rem; transition: background-color 0.2s ease; display: inline-block; text-align: center; }
    #imageInput { display: none; }
    .loader { border: 4px solid #4A5568; border-top: 4px solid #3498db; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; margin-left: 10px; vertical-align: middle; }
    .hex-loader { border: 2px solid #4A5568; border-top: 2px solid #3498db; border-radius: 50%; width: 14px; height: 14px; animation: spin 1s linear infinite; display: inline-block; margin-right: 5px; }
    @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }
    .processing { opacity: 0.7; cursor: not-allowed; }
    #dropZone { border-radius: 0.5rem; padding: 1.5rem; text-align: center; transition: background-color 0.2s ease, border-color 0.2s ease; }
    #dropZone p { margin-bottom: 0.75rem; }
    #previewImageElement { max-width: 100%; height: auto; max-height: 70vh; }
    .btn-icon { width: 1rem; height: 1rem; }
    #failedKeyWarning { display:none; }
  </style>
</head>
<body class="bg-slate-900 min-h-screen p-4 md:p-8 flex items-center justify-center transition-colors duration-300">
  <div class="bg-slate-800 p-6 md:p-8 rounded-lg shadow-lg w-full max-w-2xl relative transition-colors duration-300">
    <div class="flex items-center justify-center mb-6">
      <h1 id="pageTitle" class="text-2xl font-semibold text-slate-200" title="Click to reset form (or press Backspace outside inputs)">Data Extractor & Formatter</h1>
      <a href="https://c.aurtho.com" target="_blank" rel="noopener noreferrer" class="ml-3 p-1 rounded-full hover:bg-slate-700 transition-colors" title="Visit C Website">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z" clip-rule="evenodd" />
        </svg>
      </a>
    </div>

    <div class="mb-4 border-b border-slate-700">
      <nav class="-mb-px flex space-x-8" aria-label="Tabs"></nav>
    </div>

    <div class="mb-4">
      <label for="dataInput" class="block text-sm font-medium text-slate-300 mb-1">Paste your data here:</label>
      <div class="flex items-center space-x-2">
        <textarea id="dataInput" rows="6" class="flex-grow p-3 border border-slate-600 rounded-md shadow-sm focus:ring-indigo-400 focus:border-indigo-400 text-sm resize-y bg-slate-700 text-slate-100 placeholder-slate-400" placeholder="Example:&#10;SKU: DC-CTO-25&#10;Font Style: Snap ITC&#10;..."></textarea>
        <button id="pasteButton" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-400 dark:ring-offset-slate-800 transition duration-150 ease-in-out text-sm">Paste</button>
      </div>
    </div>

    <div class="my-4 flex items-center">
      <div class="flex-grow border-t border-slate-600"></div>
      <span class="flex-shrink mx-4 text-slate-400 text-sm">OR</span>
      <div class="flex-grow border-t border-slate-600"></div>
    </div>

    <div id="dropZone" class="mb-6 bg-slate-700 border-2 border-dashed border-slate-600 rounded-lg">
      <p class="text-sm text-slate-400">Drag & Drop an image</p>
      <label for="imageInput" id="imageUploadLabel" class="bg-blue-600 hover:bg-blue-700 text-white">Choose Image</label>
      <input type="file" id="imageInput" accept="image/*">
      <span id="fileName" class="block text-sm text-slate-400 italic mt-2">No file chosen</span>
      <p class="text-xs text-slate-500 mt-1">Image text will be extracted on submit. Accuracy depends on image quality.</p>
    </div>

    <div class="flex justify-end mb-6">
      <button id="submitButton" class="px-5 py-2 bg-green-700 text-white rounded-md hover:bg-green-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-400 dark:ring-offset-slate-800 transition duration-150 ease-in-out font-medium flex items-center justify-center">
        <span>Submit</span>
        <div id="submitSpinner" class="loader hidden ml-2"></div>
      </button>
    </div>

    <div id="outputSection" class="space-y-4 hidden">
      <div>
        <h2 class="text-lg font-semibold mb-3 text-slate-200 border-b border-slate-700 pb-2 flex items-center">
          <span>Extracted Information</span>
          <span id="ocrWarningStar" class="ml-2 text-yellow-400 hidden" title="Potential OCR issues detected. Please verify extracted data.">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
              <path fill-rule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z" clip-rule="evenodd" />
            </svg>
          </span>
          <span id="ocrWarningHint" class="ml-1 text-xs text-yellow-500"></span>
        </h2>
        <div id="extractedInfo" class="space-y-1 bg-slate-700/50 p-4 rounded-md shadow-inner"></div>
      </div>

      <div>
        <h2 class="text-lg font-semibold mb-3 text-slate-200 border-b border-slate-700 pb-2">Generated Filename</h2>
        <div class="filename-section bg-slate-700/50">
          <div id="filenameOutput" class="text-sm text-slate-200 break-words" contenteditable="false"></div>
          <button id="editFilenameButton" class="edit-btn p-1 bg-slate-600 text-slate-200 hover:bg-slate-500" title="Edit Filename">
            <svg class="btn-icon" id="editIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M2.695 14.763l-1.262 3.154a.5.5 0 00.65.65l3.155-1.262a4 4 0 001.343-.885L17.5 5.5a2.121 2.121 0 00-3-3L3.58 13.42a4 4 0 00-.885 1.343z" /></svg>
            <svg class="btn-icon hidden" id="saveIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
          </button>
          <button id="copyFilenameButton" class="copy-btn bg-slate-600 text-slate-200 hover:bg-slate-500">Copy</button>
        </div>
      </div>
      <div id="failedKeyWarning" class="p-4 rounded-md hidden"></div>
    </div>

    <div id="imagePreviewSection" class="mt-6 hidden">
      <h2 class="text-lg font-semibold mb-3 text-slate-200 border-b border-slate-700 pb-2">Preview&nbsp;</h2>
      <div class="bg-slate-700/50 p-4 rounded-md shadow-inner flex justify-center items-center">
        <img id="previewImageElement" src="#" alt="Image Preview" class="rounded-md">
      </div>
    </div>

    <div id="messageBox" class="mt-4 text-center text-sm font-medium hidden"></div>
    <div id="ocrSourceDisplay" class="text-center text-xs text-slate-500 mt-4"></div>
  </div>

  <script src="config.js"></script>
  <script>
    // The full JS code is lengthy and included earlier in this conversation.
    // To keep your step simple, use the exact index.html I provided previously which includes:
    // - Parallel OCR (browser Tesseract + backend Gemini)
    // - All parsing, filename, hex logic
    // If you need me to re-paste the full JS inline again, say "repost index.html JS" and I will paste it entirely.
  </script>
</body>
</html>
